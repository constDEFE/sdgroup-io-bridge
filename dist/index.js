var i=(a,t,e)=>new Promise((r,o)=>{var s=c=>{try{m(e.next(c))}catch(g){o(g)}},p=c=>{try{m(e.throw(c))}catch(g){o(g)}},m=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,p);m((e=e.apply(a,t)).next())});import N from"axios";import{BehaviorSubject as $,filter as L}from"rxjs";var S=(o=>(o.NATIVE="NATIVE",o.ERC20="ERC20",o.BEP20="BEP20",o.TRC20="TRC20",o))(S||{}),u=(e=>(e.APPLICATION="APPLICATION",e.USER="USER",e))(u||{}),l=(t=>(t.X_CALLER_TYPE="X-Caller-Type",t))(l||{}),k=(r=>(r.SENDING="SENDING",r.FAILURE="FAILURE",r.SUCCESS="SUCCESS",r))(k||{}),B=(e=>(e.AWAITING_PAYMENT="AWAITING_PAYMENT",e.PAID="PAID",e))(B||{}),h=(r=>(r.BITCOIN="BITCOIN",r.ETHEREUM_COMPATIBLE="ETHEREUM_COMPATIBLE",r.TRON_COMPATIBLE="TRON_COMPATIBLE",r))(h||{});var f=class{constructor(t={}){this.config=t;this.instanceServices=new Map;this.application$=new $(void 0);var e,r;this.http=N.create(),this.storage=(e=this.config.storage)!=null?e:localStorage,this.config.storageKeysPrefix=(r=this.config.storageKeysPrefix)!=null?r:"bridge",this.http.interceptors.request.use(o=>{let s=this.storage.getItem(`${this.config.storageKeysPrefix}_token`);if(o.headers.set("Authorization",`Bearer ${s}`),o.headers.get("X-Caller-Type")==="APPLICATION"){let p=this.application$.getValue();p&&(o.auth={username:p.authId,password:p.secretKey})}return o})}getService(t){return this.instanceServices.has(t)?this.instanceServices.get(t):(this.instanceServices.set(t,new t(this.http,this.storage,this.config)),this.getService(t))}useApplication(t){return this.application$.next(t),this}getSelectedApplication$(){return this.application$.pipe(L(t=>!!t))}};import{Subject as _,takeUntil as R}from"rxjs";import{useEffect as M}from"react";var K=()=>{let a=new _;return M(()=>()=>a.next(!0),[]),{untilDestroy:()=>t=>t.pipe(R(a))}};var n=class{constructor(t,e,r){this.http=t;this.storage=e;this.config=r}};var d=class extends n{constructor(t,e,r){super(t,e,r)}create(t){return i(this,null,function*(){return yield this.http.post("/api/application").then(e=>e.data)})}getApplications(){return i(this,null,function*(){return yield this.http.get("/api/applications").then(t=>t.data)})}getMyApplications(){return i(this,null,function*(){return yield this.http.get("/api/my-applications").then(t=>t.data)})}exportPrivateKey(t){return i(this,null,function*(){return"secret key"})}resetPrivateKey(t){return i(this,null,function*(){})}};var y=class extends n{constructor(e,r,o){super(e,r,o);this.authMessage="Authentication"}loginViaMetamask(){return i(this,null,function*(){if("ethereum"in window){let e=window.ethereum,o=(yield e.request({method:"eth_requestAccounts"}))[0],s=yield e.request({method:"personal_sign",params:[this.authMessage,o]}),{token:p}=yield this.http.post("/api/auth/web3",{signature:s}).then(m=>m.data);return this.storage.setItem(`${this.config.storageKeysPrefix}_token`,p),{token:p}}throw new Error("WEB3 Provider not found")})}getAccounts(){return i(this,null,function*(){return yield this.http.get("/api/auth/accounts").then(e=>e.data)})}login(e,r){return i(this,null,function*(){let{token:o}=yield this.http.post("/api/auth/login",{login:e,password:r}).then(s=>s.data);return this.storage.setItem(`${this.config.storageKeysPrefix}_token`,o),o})}isAuth(){return i(this,null,function*(){return(this.storage.getItem(`${this.config.storageKeysPrefix}_token`)||"").split(".").length===3})}logout(){return i(this,null,function*(){this.storage.removeItem(`${this.config.storageKeysPrefix}_token`)})}};var x=class extends n{getBalance(t,e,r){return i(this,null,function*(){return yield this.http.get(`/api/bridge/${t}/${e}/wallet/${r}/balance`,{headers:{["X-Caller-Type"]:"APPLICATION"}}).then(o=>o.data)})}transfer(t){return i(this,null,function*(){return yield this.http.post(`/api/bridge/${t.network}/${t.symbol}/transfer`,{from:t.from,to:t.to,amount:t.amount},{headers:{["X-Caller-Type"]:"APPLICATION"}}).then(e=>e.data)})}};var P=class extends n{constructor(t,e,r){super(t,e,r)}convert(t){return i(this,null,function*(){let e=`/api/converter/${t.from}/${t.fromDecimals}/${t.amountScaled}/${t.to}/${t.toDecimals}`;return yield this.http.get(e).then(r=>r.data)})}};var A=class{getFee(){return i(this,null,function*(){return{rate:1.1}})}};var w=class{constructor(t){this.http=t}getNetworkByCode(t){return i(this,null,function*(){let r=(yield this.getNetworks()).find(o=>o.code===t);if(!r)throw new Error(`Network ${t} not found`);return r})}getNetworks(){return i(this,null,function*(){return yield this.http.get("/api/networks",{headers:{"content-type":"application/json"}}).then(t=>t.data)})}create(t){return i(this,null,function*(){let e={name:t.name,code:t.code,kind:t.kind,url:t.url,apiKey:"",username:"",password:""};return t.kind==="TRON_COMPATIBLE"&&(e.apiKey=t.apiKey),yield this.http.post("/api/network",e)})}delete(t){return i(this,null,function*(){yield this.http.delete(`/api/network/${t}`)})}};var b=class extends n{constructor(t,e,r){super(t,e,r)}getOffers(){return i(this,null,function*(){return yield this.http.get("/api/offers").then(t=>t.data)})}};var I=class extends n{getPayments(){return i(this,null,function*(){return yield this.http.get("/api/payments",{headers:{["X-Caller-Type"]:"APPLICATION"}}).then(t=>t.data)})}getPaymentById(t){return i(this,null,function*(){return yield this.http.get(`/api/payment/${t}`).then(e=>e.data)})}createPayment(t){return i(this,null,function*(){return yield this.http.post("/api/payment",t,{headers:{["X-Caller-Type"]:"APPLICATION"}}).then(e=>e.data)})}manualPay(t,e){return i(this,null,function*(){return yield this.http.post(`/api/payment/${t}/pay`,e).then(r=>r.data)})}};import{defer as U,from as D,share as W,throttleTime as q}from"rxjs";var C=class{constructor(t){this.http=t;this.$tokenStream=U(()=>D(this.getTokens())).pipe(W(),q(1e4))}getTokensBySymbol(t,e){return i(this,null,function*(){let o=(yield this.getTokens()).find(s=>e?s.symbol===t&&s.network.code===e:s.symbol===t);if(!o)throw new Error(`Token ${t}[${e!=null?e:""}] not found`);return o})}getTokens(){return i(this,null,function*(){return yield this.http.get("/api/tokens").then(t=>t.data)})}create(t){return i(this,null,function*(){return yield this.http.post("/api/token",t).then(e=>e.data)})}delete(t){return i(this,null,function*(){yield this.http.delete(`/api/token/${t}`)})}};var T=class extends n{constructor(t,e,r){super(t,e,r)}getWalletsWithBalances(){return i(this,arguments,function*(t={}){let e=new URLSearchParams;return t.owners&&t.owners.length&&e.set("owners",t.owners.join(",")),yield this.http.get("/api/wallet-balances",{params:e}).then(r=>r.data)})}};var E=class extends n{constructor(t,e,r){super(t,e,r)}getWallets(){return i(this,arguments,function*(t={}){let e=new URLSearchParams;return t.owners&&t.owners.length&&e.set("owners",t.owners.join(",")),yield this.http.get("/api/bridge/wallets",{params:e}).then(r=>r.data)})}};import O from"bignumber.js";var v=class{static fromCents(t,e=8,r=e){return new O(Number(t)).dividedBy(10**e).toFixed(r)}static toCents(t,e=8){return new O(Number(t)).multipliedBy(10**e).toFixed(0)}};export{v as AmountTransform,d as ApplicationService,y as AuthService,x as BridgeService,u as CallerType,P as ConverterService,A as FeeService,l as HeadersEnum,w as NetworkService,h as NetworkType,b as OfferService,B as PaymentStatus,k as PaymentWebhookStatus,I as PaymentsService,n as Service,C as TokenService,S as TokenType,T as WalletBalanceService,E as WalletService,f as default,K as useDestroy};
//# sourceMappingURL=index.js.map